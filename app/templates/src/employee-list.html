<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../bower_components/paper-material/paper-material.html">
<link rel="import" href="../bower_components/vaadin-combo-box/vaadin-combo-box.html">
<link rel="import" href="../bower_components/vaadin-grid/vaadin-grid.html">

<dom-module id="employee-list">
  <template>
    <style>
      :host {
        display: block;
      }

      paper-material {
        background-color: white;
        margin: 24px;
        padding: 16px;
      }
    </style>

    <iron-ajax
      auto
      url="employees.json"
      handle-as="json"
      last-response="{{_employees}}"></iron-ajax>

    <paper-material elevation="1">
      <vaadin-combo-box label="Filter by first name" items="[[_names]]" value="{{_filterValue}}"></vaadin-combo-box>
      <vaadin-grid id="grid" items="{{_employees}}">
        <table>
          <colgroup>
            <col>
            <col>
            <col>
          </colgroup>
          <thead>
            <tr>
              <th>Name</th>
              <th>Surname</th>
              <th>Activity</th>
            </tr>
          </thead>
        </table>
      </vaadin-grid>
    </paper-material>

  </template>
  <script>
    Polymer({
      is: 'employee-list',

      properties: {
        _names: {
          type: Array,
          value: function() {
            return ['Artur', 'Patrik', 'Henrik', 'Teemu'];
          }
        },
        _employees: {
          type: Array,
          value: function() {
            return [];
          }
        },
        _filterValue: {
          type: String,
          observer: '_filterValueChanged',
          value: ''
        }
      },

      _filterValueChanged: function() {
        this.$.grid.items = this._employees.filter(function(val) {
          if (this._filterValue) {
            return (val[0].toLowerCase()).indexOf(this._filterValue.toLowerCase()) > -1;
          } else {
            return true;
          }
        }.bind(this));
      }
    });
  </script>
</dom-module>
